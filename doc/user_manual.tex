\documentclass[10pt]{report}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{floatrow}
\usepackage{float}
\usepackage{listings}
\usepackage{color}
\def\euro{\mbox{\raisebox{.25ex}{{\it =}}\hspace{-.5em}{\sf C}}} 
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}


\lstset{
	language=bash,
	basicstyle=\scriptsize\ttfamily,
	commentstyle=\ttfamily\color{white},
	numbers=left,
	numberstyle=\ttfamily\color{white}\footnotesize,
	stepnumber=1,
	numbersep=5pt,
	backgroundcolor=\color{white},
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	frame=single,
	tabsize=2,
	captionpos=b,
	breaklines=true,
	breakatwhitespace=false,
	title=\lstname,
	escapeinside={},
	keywordstyle={\color{white}},
	morekeywords={\color{white}},
	stringstyle={\color{white}}
}



\title {TilEm2 USER MANUAL}
\author {DUPONCHELLE Thibault - MOODY Benjamin}


\begin{document}
\maketitle

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilem2.png}}
\caption{TilEm2}
\end{figure}


\tableofcontents

\chapter{Introduction}
\section{What's TilEm2?}
TilEm2 is a TI calculator emulator. It emulates all the Z80 calculators (73, 76.fr, 81, 82, 82stats, 82stats.fr, 83, 83+, 83+ SE, 84+, 84+ SE, 85, and 86) and all known ROM/OS versions.\newline
TilEm2 is completely free, and designed for Linux (but available for Windows).\newline
We put a lot of work in this software to offer to the community the best possible product.\newline
TilEm2 also provides a full featured debugger with disassembler, breakpoints, memory view and more.\newline


\section{Some history}
Some of you probably already know TilEm because a first version was released around 2000/2001 by Julien Solignac (then maintained by Benjamin Moody since 2004).\newline
This first version was working fine but there were some issues, skins were too small and bad resolution and a lot of feature were missing.\newline
Anyway, this software was pretty good (especially because the core emulation was very good).\newline

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilem_old.png}}
\caption{The "old" TilEm}
\end{figure}

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilem_old_menu.png}}
\caption{The "old" TilEm menu}
\end{figure}

We decided to rewrite this emulator from scratch, keeping the philosophy of TilEm but improving all the rest.\newline
A new core has been developped by Benjamin Moody (aka "floppusmaximus"), and I (Thibault Duponchelle aka "contra-sh") started to work on the GTK user interface (later he helped me for this task).\newline\newline
We are proud to release our work for beta testing !

\section{Features}
TilEm2 has basically all the TilEm old features plus a lot of new things :\newline
\begin{itemize}
\item   Emulates all TI z80 calc.
\item	Emulates all known rom/OS versions.
\item	Linking : Send and receive var (use libticalcs2). 
\item	Screenshot.
\item	Animated screenshot. 
\item	Grayscale. 
\item	Save states.
\item	Use TiEmu skin file format (easy to do your own skin).
\item	And more...
\end{itemize}

Here's the right click menu option :\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/popup.png}}
\caption{The right click popup menu}
\end{figure}


\section{What TilEm2 do NOT do}
TilEm2 do a lot of stuff that TilEm1 was not able to do, but there's always some feature not implemented (yet).\newline
\begin{itemize}
\item Sound handling
\item Calc to calc linking
\end{itemize}
But do not forget that developpement goes on and we are planning to do it !\newline



\section{Skins}
You can use TilEm2 without skin (just uncheck the "Use skin" checkbox into the Preferences menu) but skins are more user friendly :)\newline
We have made some officials and free to use skins (thank you to our contributors).\newline
You can do your own skins using skinedit. If you want, you can send us the skin file, maybe it could become "official".\newline\newline
What do you need to do your own skin?\newline
Just take a picture of your calc using your smartphone by example.\newline
Scale it keeping proportion to have around 900 pixels high.\newline
Then start skinedit, create a new skin, open the picture and set the key positions.\newline
It takes less than 20/30 minutes I think.\newline
See the chapter "Create your own skins" to know how to do.\newline
Then you can test it with TilEm2.That's all!\newline
Here are the current skins available by default :\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/diaporama_skin.png}}
\caption{The skins}
\end{figure}

\chapter{Installation}
\section{Generalities}
Before installing TilEm2, you should know that no ROM is included in this software.\newline
In order to use TilEm2, you must use your own rom (use TILP to get it).\newline
TilEm2 provides an installer msi for windows and script autoconf for Linux.\newline
There's not a lot of dependancies so you should really have no problem to install it.\newline

\section{Dependancies}
TilEm2 uses the following libraries :\newline
\begin{itemize}
\item	GTK+ 2.6 or higher (but 3.x not supported yet).
\item	libticalcs2.
\end{itemize}
You can find libticalcs2 on ticalc (from Romain Lievins).\newline

\section{Install from sources}
Download the sources of TilEm2 on sourceforge.net.\newline
Or eventually :\newline
Dowload the source from the trunk like this :\newline
\begin{lstlisting}
svn co https://tilem.svn.sourceforge.net/svnroot/tilem\newline\newline
\end{lstlisting}

Then install gtk+ (e.g. for debian : sudo apt-get install libgtk2.0-dev).\newline
Then install libticalc2.\newline\newline
(http://www.ticalc.org/archives/files/fileinfo/374/37479.html)\newline\newline

After that, simply use the configure script and the well know Linux install :\newline
\begin{lstlisting}
./configure
\end{lstlisting}
If you have no errors, so dependancies are checked and it's ok.\newline
The Makefile have been generated so type:\newline
\begin{lstlisting}
make
\end{lstlisting}
Then to copy the icons, configuration files and tilem2 binary type:\newline
\begin{lstlisting}
sudo make install
\end{lstlisting}

Usually, icons will be copied into /usr/share/tilem2/\newline
Keybindings and configuration file will be installed into \$HOME/.config/tilem2\newline

Then you can launch TilEm2 with the command :\newline
\begin{lstlisting}
tilem2 -r /path/to/rom
\end{lstlisting}

Or simply :\newline
\begin{lstlisting}
tilem2
\end{lstlisting}

\section{First use}
If you do not specify explicitely a rom on the command line, the first launch will ask you which rom you want to use.\newline
If you don't know what's a rom or how to get it, please read the chapter "Get a rom".\newline
TilEm2 will open a file chooser dialog.\newline

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/first_use_rom_chooser.png}}
\caption{Starting TilEm2 for the first time}
\end{figure}

As soon you press "Ok", TilEm2 will try to guess the model of this rom (and check if it's a correct rom).\newline
When TilEm2 has a doubt, he will ask you for the model but will display only the possible candidates (not all the z80 calc).\newline
Anyway, if you launch a rom, you usually know what's model it is because as I've already said : you should have the calculator of the rom you're trying to emulate...\newline

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/first_use_model_chooser.png}}
\caption{Choose the model}
\end{figure}

After that, TilEm2 start (but calc is off you need to press on).\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/first_use_works_fine.png}}
\caption{It works !}
\end{figure}
The last used rom is automatically used for the next launch of TilEm2.\newline
You can save the current state of the calculator by using "Save Calculator".\newline
If you cancel the rom chooser dialog, TilEm2 automatically shutdown.\newline

\chapter{Get a rom}

As we said before, you must provide a rom to TilEm to get it working correctly.\newline
A rom is the brain of the calculator, TilEm only emulate the body (hardware).\newline
We can't provide a rom for you because this is not allowed by the law.\newline
There's many way to get a rom, here are some of them : \newline
\begin{itemize}
\item Get it from your calculator using tilp.
\item Download it from the web (you must have the real calc in your possession!!)
\end{itemize}

\section{Get a rom using tilp}
Launch your best friend tilp2 as always.\newline\newline
Here's what you have usually:\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/tilp2_window.png}}
\caption{The tilp main window}
\end{figure}

At this point, you should be able to dirlist your calc (if not, the calc is not connected).\newline
In this case, change the cable or the model and retry.\newline
Try to launch tilp in sudo or root mode, sometimes it helps.\newline\newline
Then click on the "Op√©rating System" label:\newline 
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilp2_getrom_warning.png}}
\caption{The warning about the law}
\end{figure}

In fact, tilp2 sends a romdumper to the calc, the execute it remotely and get the rom.\newline

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilp2_getrom_dumper.png}}
\caption{The warning before launching rom dumper}
\end{figure}
Click forward !!\newline

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/tilp2_getrom_transfert.png}}
\caption{The transfert}
\end{figure}


\section{Get a rom from the web}

This is the fastest method to get a rom but you must have the calc in your possession.\newline
So please be careful about the law.\newline
I can't give you links, but there's a lot of website which allow you to get a rom without using tilp.\newline

\chapter{Main features}

In addition to emulate the behaviour of a real calc, TilEm2 features main functionnalities as file loading and file export, screenshot, debugger.\newline
In this chapter, we will talk about these main features.\newline
In an another chapter, yoou will find a detailled explanation of all options of TilEm2.\newline

\section{Send a file from PC to TilEm2}

Here we talk about sending a file from computer to emulated calc.\newline
You downloaded a file on the web and you want to test it before sending it to your calc?\newline
You compiled a file and you want to see the result?\newline
So you probably want to use send file feature...\newline\newline
There's 3 ways to do that.\newline

\subsection{Using the right click menu option}

Firstly right click on the calc.\newline
This menu popup will appear : \newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/send_file.png}}
\caption{The "Send File..." menu entry}
\end{figure}
Click on Send file...\newline
(You can bypass the popup menu by clicking CTRL + O)\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/send_file_chooser.png}}
\caption{The "Send File..." file chooser dialog}
\end{figure}
Then explore your computer and choose the file(s) you want to send.\newline
Usually, variable are suffixed by something like .82p (ti82), .83p (ti83) .8xp (ti83+, ti84+), .86p (ti86) or something else.\newline
Grouped files are generally suffixed by .82g (ti82), .83g (ti83), .8xg (ti83+, ti84+).86g (ti86) or something else.\newline
Some other special extension as .8kv are flashapp for ti83+, ti84+.\newline
And a lot of other file extension.\newline

It could take some time to load a variable so a current progress bar is printed while loading to know what's happening.\newline

As soon as you press OK, the file start to be loaded and a progress bar is displayed.\newline

\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/send_file_loading.png}}
\caption{The "Senf File..." progress bar update}
\end{figure}


\subsection{Using drag and drop}
Simply select one or more files on your computer and use drag and drop to

\begin{figure}[H]
\centering
\scalebox{0.3}{\includegraphics{pixs/send_file_drag_and_drop.png}}
\caption{Drag and Drop}
\end{figure}

You will not see any visual feedback (no progress bar) but you can see in your terminal eventually the libticalcs debugging messages.\newline

\begin{figure}[H]
\centering
\scalebox{0.3}{\includegraphics{pixs/send_file_drag_and_drop_libticalcs.png}}
\caption{Drag and Drop}
\end{figure}


You can check if your program is correctly uploaded to calc by listing them inside the program menu (if it's a program) :
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/send_file_list.png}}
\caption{Check if a programs is uploaded correctly (here on a ti83)}
\end{figure}

\subsection{Using the command line}

You can also send a file to the calc at startup using command line parameters.\newline
All the non options args are sent to the calc.\newline

\begin{lstlisting}
tilem2 -r $rom ion.83g
\end{lstlisting}
This example will load the group file ion.83g in the calc memory.\newline

\section{Get a var from calc to PC}

To get a program, list, screen, application or whatever which is considered are a var on the calc you need to use the right click menu options :\newline
(Or you can simply use CTRL + S)\newline

\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/receive_file.png}}
\caption{The "Receive File..." dialog}
\end{figure}

At this point, TilEm2 will (try to) get the variables and print them into a list.\newline
This is why you will see the progress bar.\newline
Warning : update is not done each time the window is popup, you need to refresh manually the vars.\newline\newline
You can select one or more vars in the list then saving it by clicking "Save".\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/receive_file_list.png}}
\caption{Listing the variables}
\end{figure}

A check button lets you choose the format of the output.\newline
If you want to get more than one var, you can save it as grouped file or as separate files (separate files is as you get it one by one).\newline

\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/receive_file_separate_or_grouped.png}}
\caption{Listing the variables}
\end{figure}

Then simply click save and choose a place to backup the var(s).\newline


\section{Record or grab a screenshot}

\subsection{Grab a screenshot using "Quick Screenshot"}

You can grab a screenshot without using screenshot dialog.\newline
Simply click on the "Quick Screenshot" menu option or SHIFT + CTRL + PRINT.\newline
The screenshot use the default options (or the options you have given into screenshot dialog).\newline
The picture is stored into the directory you usually use for screenshot OR if not exists into the ~/.config/tilem2/screenshots/ or equivalent if you're not on Linux.\newline

\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/quick_screenshot.png}}
\caption{The "Quick Screenshot" submenu}
\end{figure}

\subsection{Grab a screenshot using the screnshot dialog}

Click on "Screenshot" menu option or use CTRL + PRINT.\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/screenshot.png}}
\caption{The "Screenshot..." submenu}
\end{figure}

The screenshot window will open.\newline
TilEm2 automatically grab a screenshot at startup.\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/screenshot_dialog_grab.png}}
\caption{The window opens with a first grabed screenshot}
\end{figure}

You can choose to "Save" it or to grab another screenshot.\newline
There's a lot of options as size, foreground/background color etc...\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/screenshot_dialog.png}}
\caption{The options}
\end{figure}

There's some differents kind of output format as png, bmp or some other else.\newline

\subsection{Record a gif}

Click on "Screenshot" menu option or use CTRL + PRINT.\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/screenshot.png}}
\caption{The "Screenshot..." submenu}
\end{figure}

The screenshot window will open.\newline
\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/screenshot_dialog.png}}
\caption{The "Screenshot" window}
\end{figure}

You can record a gif by clicking "Record".\newline
Stop the gif by clicking "Stop" (What a surprise :D).\newline
As soon you click "Stop", a preview is available in the picture area.\newline
There's a lot of options as size, foreground/background color etc...\newline
You can set these options after recording the animation.\newline

When you have the desired animation, clickon "Save" button and choose a place and a filename to save the gif.\newline

\chapter{List of functionnalities}
\section{Menu}
As TilEm1, the menu is a popup menu (right click).\newline
All you want to do need to use this menu.\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/popup.png}}
\caption{The right click menu}
\end{figure}
As you can see, there's all you need, no more, no less:\newline
\begin{itemize}
\item	Send File... : Load a file from your computer to TilEm2.
\item	Receive File : Launch a menu where you can store a variable from TilEm2 to your computer.
\item	Open Calculator... : Load a ROM.
\item	Save Calculator : Save the current state of the calculator (in a separate sav file)
\item	Revert Calculator : Revert the state of the calculator.
\item	Reset Calculator : Reset the calc of course.
\item	Debugger : Open the debugger window.
\item	Macro : Record, play, open or save a macro (a kind of script to do some actions automatically).
\item	Screenshot : Open the screenshot menu (static and animated screenshot).
\item	Quick Screenshot : Grab a screenshot and save it without prompting (that's why it's "quick").
\item	Preferences : Open the preference window.
\item	About : Open the about dialog (informations on the authors and more)
\item	Quit : Close TilEm2 properly
\end{itemize}

\section{Send File...}

\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/send_file.png}}
\caption{The "Send File..." menu entry}
\end{figure}
This is one very important feature, because emulators are usually used to try some programs before really transferring it to real calc.\newline\newline
When you click on this menu entry, a file chooser dialog is opened and let you choose a file.\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/send_file_chooser.png}}
\caption{The "Send File..." file chooser dialog}
\end{figure}
A lot of people don't know which file extension is associated with the emulated model...\newline
To help them, some patterns are used to do the selection.\newline
When you let "All compatible files", TilEm2 do the job for you, but you can choose "All files" if you know what you're doing (a file with an incorrect extension by example).\newline
\begin{figure}[H]
\centering
\scalebox{1}{\includegraphics{pixs/send_file_chooser_pattern.png}}
\caption{The "Send File..." patterns}
\end{figure}

It could take some time to load a variable so a current progress bar is printed while loading to know what's happening.\newline

\begin{figure}[H]
\centering
\scalebox{0.5}{\includegraphics{pixs/send_file_loading.png}}
\caption{The "Senf File..." progress bar update}
\end{figure}

\section{Receive File...}
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/receive_file.png}}
\caption{The "Receive File..." menu entry}
\end{figure}
When you click on "Receive File..." menu entry, TilEm2 firstly get the vars then prints it into a listview.\newline
\begin{figure}[H]
\centering
\scalebox{0.6}{\includegraphics{pixs/receive_file_loading.png}}
\caption{The "Receive File..." get the variables}
\end{figure}
After the first launch, refresh is made only on request !\newline
If you click "Receive File..." then close the window, then create a program and click "Receive File..." you will not see your program.\newline
The variable list let you choose the stuff you want to backup.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/receive_file_list.png}}
\caption{The "Receive File..." window}
\end{figure}
If more than one variable is selected, you can choose between two modes of backup :
"Separate files" or "Group file".\newline
If you choose separate, each file is saved as if you have saved one by one.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/receive_file_separate_or_grouped.png}}
\caption{The two modes of backup (multiple files only)}
\end{figure}
If you save grouped, a group file will be created on disk.\newline
When you finally click on "Save" button, a file save dialog is opened.\newline
Choose a directory and a name and click "Save".\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/receive_file_chooser.png}}
\caption{The "Receive File..." file save}
\end{figure}

\section{Open Calculator...}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/open_rom.png}}
\caption{The "Open Calculator..." menu entry}
\end{figure}
When you click on "Open Calculator...", a file chooser dialog pop up and let you choose a rom to load.\newline
So in fact even if you already emulates a calculator, you can switch to another just by opening a new rom file.\newline
Another way to do that is to quit TilEm2 and restart it using another rom file (option -r).\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/open_rom_chooser.png}}
\caption{The "Open Calculator..." file chooser}
\end{figure}
Rom files usually finish by .rom as extension but you can use "All files" pattern if you have a rom with a odd extension.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/open_rom_chooser_pattern.png}}
\caption{The file chooser patterns}
\end{figure}


\section{Save Calculator...}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/save_calculator.png}}
\caption{The "Save Calculator" menu entry}
\end{figure}

This option just save the current state of the calculator in a .sav file.\newline
The file is created in the same directory as the rom file and with the same name.\newline
\section{Revert Calculator State}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/revert_calculator.png}}
\caption{The "Revert Calculator State" menu entry}
\end{figure}

No surprise, this option just revert the calculator state (if possible).\newline

\section{Reset Calculator}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/revert_calculator.png}}
\caption{The "Reset Calculator" menu entry}
\end{figure}

Guess what does this option :)

\section{Debugger}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger.png}}
\caption{The "Debugger" menu entry}
\end{figure}
When you click on this option, the debugger window will appear.\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_dialog.png}}
\caption{A nice and powerful debugger}
\end{figure}
There's a lot of things to say about debugger.\newline
When you launch it, calculator is automatically paused.\newline
As you can see there are 5 big buttons : Run, Pause, Step, Step Over, Finish Subroutine.\newline
Step just execute one instruction.\newline
As you can see, all the instructions are not the same length, that's why it doesn't step one byte per one byte.\newline
Step over do the same job than step but do not follow call.\newline
Finish subroutine just do basically the same job but stop after a ret.\newline

Now just see what's the differents view of the debugger dialog.\newline
There's a big frame for disassembly view.\newline
In this frame, you can see the adress and the disassembly instruction.\newline
On right click, you can do some useful actions : Breakpoint here, Go to adress, go to PC.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_disasm_popup.png}}
\caption{The right click menu on disasm view}
\end{figure}

There's 2 kind of adress notation for this view : Logical and Absolute.\newline 
You can switch it into the "View" menu.\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_logical.png}}
\caption{Switch between logical and absolute adresses}
\end{figure}
The second big frame is the memory view.\newline
For this view you can switch the adresses representation if you want.\newline
In this view you can see what your calculator contains.\newline
You can also edit the memory and change some values by your own.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_memory_edit.png}}
\caption{Edit the memory}
\end{figure}
A third view represents the registers.\newline
You can edit them too.\newline
Below registers there is a bunch of toggle button to represent the flags (you can change it).\newline
Then Interruption Mode IM, I, and Enable Interrupt (checkbox).\newline
The finally the stack.\newline

At the top of the debugger window, you can see a menu "Debug".\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_debug.png}}
\caption{The "Debug" menu entry}
\end{figure}
The options are the same than buttons but there is a big news : breakpoints.\newline
Breakpoints are a big part of the life of a assembly developpers.\newline
This option opens the Breakpoint menu when you can "Add", "Remove", "Edit", "Clear" or some special action like "Break on invalid instructions" or "Break on undocumented instructions".\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_breakpoint.png}}
\caption{The "Breakpoints" menu}
\end{figure}
The easiest way to add a breakpoint is to right click on the disasm view and click on "Breakpoint here" but you can also set a breakpoint using its adress (logical or absolute).\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_breakpoint.png}}
\caption{Adding a breakpoint}
\end{figure}

The "Go" menu basically provide and easy way to navigate into the disasm view and th e stack.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_go.png}}
\caption{The "Go" menu entry}
\end{figure}

Now I must talk about a nice tool called Keypad (into View menu).\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/debugger_keypad.png}}
\caption{The keypad}
\end{figure}

\section{Macro}

Macros are an easy way to simulates key press, file loading, reset automatically.\newline
It means that you could record a macro then click on some keys, then stop.\newline
If you play it, tilem will press the same keys for you.\newline
Have you never think too lazy to press always "2nd catalog asm(" each time you want to test your new asm production.\newline
Simply use a macro to load and launch your program automatically !\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/macro.png}}
\caption{The "Macro" submenu}
\end{figure}
About the options, you can play an already loaded macro or a macro you just have recorded.\newline
You can also open a macro and save the current macro (which one you just have recorded).\newline

\section{Screenshot...}
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/screenshot.png}}
\caption{The "Screenshot..." submenu}
\end{figure}
By clicking on this option, you launch a screenshot dialog.\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/screenshot_dialog.png}}
\caption{The screenshot dialog}
\end{figure}
You can grab static screenshot (multiple format) or animated screenshot (will be saved as gif).\newline
As you can see TilEm2 has a lot of screenshot configuration.\newline
So you can change the size, change the foreground and background colors.\newline
Use or not grayscale.\newline

\section{Quick Screenshot}
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/quick_screenshot.png}}
\caption{The "Quick Screenshot" submenu}
\end{figure}
By clicking on this option, you grab a screenshot.\newline


\section{Preferences}

This is where you can set the skin (or disable using it) and some important other stuff.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/preferences.png}}
\caption{The "Preferences" menu entry}
\end{figure}

You can limit speed or not.\newline
Emulate grayscale (if you don't know just let it checked by default).\newline
Use smooth scrolling.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/preferences_dialog.png}}
\caption{The preferences dialog}
\end{figure}
And an important user friendly feature...\newline
Set skin !\newline
When you click on the button, a file choose will popup and lt you choose the skin.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/skin_file_chooser.png}}
\caption{The skin file chooser}
\end{figure}

\section{About}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/about.png}}
\caption{The "About" menu entry}
\end{figure}
No more than an about dialog :)\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/about_dialog.png}}
\caption{The about dialog}
\end{figure}

\section{Quit}

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/quit.png}}
\caption{The "Quit" menu entry}
\end{figure}
Bye Bye ;)

\chapter{Command line usage}

\section{Basics}
TilEm2 is basically made for Linux and command line is our first love :)\newline
Here the options at launch.\newline
\begin{lstlisting}
Usage:
  tilem2 [OPTION...] FILE

Help Options:
  -h, --help                Show help options
  --help-all                Show all help options
  --help-gtk                Show GTK+ Options

Application Options:
  -r, --rom=FILE            The rom file to run
  -k, --skin=FILE           The skin file to use
  -m, --model=NAME          The model to use
  -f, --file=FILE           The file to load
  -s, --state-file=FILE     The state-file to use
  -l, --without-skin        Start in skinless mode
  --reset                   Reset the calc at startup
  --get-var=FILE            Get a var at startup
  -p, --play-macro=FILE     Run this macro at startup
  -d, --debug               Launch debugger
  --normal-speed            Run at normal speed
  --full-speed              Run at maximum speed
  --display=DISPLAY         X display to use
\end{lstlisting}

You should usually use something like : \newline
tilem2 -r /path/to/my/rom\newline\newline

But as you can see you can specify the skin with -k.\newline
If you usually use more than one model, you can try -m and it will load the rom associated with this model (if you already start a rom from this model).\newline
You can specify a different save state (by default it uses the one which is called as the rom file).\newline
You can start skinless.\newline
You can load a file and even launch a macro at startup (in this case loading a file is done before macro playing).\newline
You can reset too, get a var (if possible) and launch debugger.\newline
Some options could be set at startup as normal speed or full speed (as fast as possible).\newline
Other options are not TilEm2 options (--display by example).\newline
Something is missing?\newline

\section{Examples}

First starting using configuration file (need to have already started one time before). 
\begin{lstlisting}
tilem2
\end{lstlisting}
You can specify the rom to use:\newline
\begin{lstlisting}
tilem2 -r /path/to/my/rom.rom
\end{lstlisting}
You can choose a skin at startup
\begin{lstlisting}
tilem2 -r /path/to/my/rom.rom -k /path/to/my/skin
\end{lstlisting}
Choose a save save state: \newline
\begin{lstlisting}
tilem2 -r /path/to/my/rom.rom -k /path/to/my/skin.skn -s /path/to/my/savestate.sav
\end{lstlisting}
Or just starting a model without giving a rom file:\newline
\begin{lstlisting}
tilem2 -m ti83
\end{lstlisting}
Starting skinless :\newline
\begin{lstlisting}
tilem2 -m ti83 -l
\end{lstlisting}
Reset the calc at startup :\newline
\begin{lstlisting}
tilem2 -m ti82 --reset
\end{lstlisting}
Trying to get a var at startup:\newline
\begin{lstlisting}
tilem2 -m ti82 --get-var=ION
\end{lstlisting}
Starting in full speed mode:\newline
\begin{lstlisting}
tilem2 -r $rom --full-speed
\end{lstlisting}
Or in normal speed:
\begin{lstlisting}
tilem2 -r $rom --normal-speed
\end{lstlisting}
Play a macro at startup:\newline
\begin{lstlisting}
tilem2 -r $rom -f /path/to/my/best/program -p /path/to/my/macro
\end{lstlisting}
Warning, in this situation, load + macro play, the load is done before the macro playing.\newline\newline
You can also launch debugger (and pause the calc by extension) :\newline
\begin{lstlisting}
tilem2 -r $rom -d
\end{lstlisting}

\chapter{Configuration files}
\section{General configuration}
You should not edit this file because you don't need it.\newline
If something wrong, by your fault or a bug in TilEm2, just get a new configuration file from the TilEm2 website and replace the wrong config.ini file.\newline
It's usually copied into ~/.config/tilem2/config.ini\newline
\section{Keybindings}
The keybindings are defined in a keybindings.ini file (usually copied into ~/.config/tilem2/keybindings.ini).\newline
There's currently no tool to interactively edit this file, but you can edit it by hand if you do this carefully.\newline
This file uses inheritance, it means that a part of the keybindings are common to all models, but you can rewrite them for each model.\newline
So firstly, TilEm2 parses common, then if he find another keybindings for the same keypress, he rewrite it.\newline
There's one subsection per model.\newline

Here's a piece of the keybindings file :\newline
\begin{lstlisting}
Up                = Up
KP_Up             = Up
Down              = Down
KP_Down           = Down
Left              = Left
KP_Left           = Left
Right             = Right
KP_Right          = Right
Shift+Up          = 2nd, Up
Shift+Down        = 2nd, Down
Tab               = 2nd 
KP_Tab            = 2nd 
ISO_Left_Tab      = 2nd 
Delete            = Del 
KP_Delete         = Del 
BackSpace         = Left, Del 
0                 = 0
KP_0              = 0
1                 = 1
KP_1              = 1
2                 = 2
KP_2              = 2
3                 = 3
KP_3              = 3
4                 = 4
KP_4              = 4
5                 = 5
KP_5              = 5
6                 = 6
KP_6              = 6
7                 = 7
KP_7              = 7
8                 = 8
KP_8              = 8
9                 = 9
KP_9              = 9
\end{lstlisting}

Left values are the computer keyboard key names.\newline
Right values are calc keys.\newline
+ means pressing the two or more keys simultaneously.\newline
, means the same thing for the calc.\newline
We know that it's not easy for you to modify this file, but if you make a mistake, tilem will say "error while parsing keybindings" but it works even.\newline
In the future, we will probably add a user interface integrated to TilEm to change keybindings, but for the moment it doesn't exist !\newline

\chapter{Tips and tricks for developpers}

Here are some tips to help you to develop your projects.\newline

\section{Scripting you application}
Each time you compile your program, if you must do 5 or 6 click to launch you program on the emulator that's pretty annoying.\newline\newline
Record a macro to do that and execute it at startup.\newline
If you load files, they are stored into the memory before the macro is launched.\newline
So record a macro and put it with your project (here into macro/play.txt).\newline
Here's a sample of what you can do:\newline
\begin{lstlisting}
#!/bin/bash
make	# Compile
tilem2 PROG.8xp -p macro/play.txt
\end{lstlisting}

I put this code into exec.sh then for testing my program I simply do :\newline
\begin{lstlisting}
./exec.sh
\end{lstlisting}

And my file is loaded and launched.

\chapter{Create your own skin}

As mentionned previously, TilEm2 uses a TiEmu skin file format.\newline
So it's easy to do your own skins.\newline

\section{Download tiem-skinedit}

Skinedit is a part of TiEmu, you can download it here :\newline
http://www.ticalc.org/archives/files/fileinfo/232/23201.html\newline

\section{Create the skin}
Now, I will explain to you how to create your own skins.\newline
A picture of a game boy will be our example.\newline

\begin{figure}[H]
\centering
\scalebox{0.9}{\includegraphics{pixs/gameboy.jpg}}
\caption{Game boy}
\end{figure}

Firstly you need to download tiemu-skinedit (author : Julien Solignac).\newline
Then launch it by :\newline
\begin{lstlisting}
tiemu-skinedit &
\end{lstlisting}


skinedit starts...\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/skinedit_start.png}}
\caption{The skinedit window}
\end{figure}
Click on File -> New .\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/skinedit_file_new.png}}
\caption{Create a new skin}
\end{figure}

Choose a picture then click "Ok".\newline

Then find a picture and resize it to 900 pixels of height (keeping the proportions).\newline
Usually I use TheGimp like this.\newline
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/gimp_resize.png}}
\caption{Resize the picture}
\end{figure}

But it works with any size, just 900 pixels is nice I think.\newline
The picture is loaded and a popup ask you to give some informations (title, author, model, contrast.\newline

\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/skinedit_picture_properties.png}}
\caption{Skinedit ask properties}
\end{figure}


Then click on "LCD" then select the region dedicated to LCD (right clikc to save).\newline
Click keys then define the region for each keys (or only some of them).\newline
\begin{figure}[H]
\centering
\scalebox{0.3}{\includegraphics{pixs/skinedit_define_keys.png}}
\caption{Define the keys}
\end{figure}

When it's ok, save the file with a skn file extension.\newline

And let's see the result ! 
\begin{figure}[H]
\centering
\scalebox{0.8}{\includegraphics{pixs/gameboy.png}}
\caption{No comment !}
\end{figure}

You can also convert a TiEmu or VTI skin file using skinedit then use it with TilEm2 !\newline

Do not hesitate to send us your skins file, maybe we could use it as official skin !\newline

\end{document}
